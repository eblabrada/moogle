\documentclass{report}
\usepackage[total={18cm,21cm},top=2cm, left=2cm]{geometry}
\usepackage{xcolor}
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{url, hyperref}

%poner codigo fuente en latex
\usepackage{color}
\definecolor{gray97}{gray}{.97}
\definecolor{gray75}{gray}{.75}
\definecolor{gray45}{gray}{.45}

\usepackage{listings}
\lstset{ frame=Ltb,
	framerule=0pt,
	aboveskip=0.5cm,
	framextopmargin=2pt,
	framexbottommargin=2pt,
	framexleftmargin=0.4cm,
	framesep=0pt,
	rulesep=.4pt,
	backgroundcolor=\color{white},
	rulesepcolor=\color{black},
	%
	stringstyle=\ttfamily,
	showstringspaces = false,
	basicstyle=\small\ttfamily,
	commentstyle=\color{gray45},
	keywordstyle=\bfseries,
	%
	numbers=none,
	numbersep=15pt,
	numberstyle=\tiny,
	numberfirstline = false,
	breaklines=true,
}

\usepackage{listings}
\lstset{ frame=Ltb,
	framerule=0pt,
	aboveskip=0.5cm,
	framextopmargin=2pt,
	framexbottommargin=2pt,
	framexleftmargin=0.4cm,
	framesep=0pt,
	rulesep=.4pt,
	backgroundcolor=\color{white},
	rulesepcolor=\color{black},
	%
	stringstyle=\ttfamily,
	showstringspaces = false,
	basicstyle=\small\ttfamily,
	commentstyle=\color{gray45},
	keywordstyle=\bfseries,
	%
}

% minimizar fragmentado de listados
\lstnewenvironment{listing}[1][]
{\lstset{#1}\pagebreak[0]}{\pagebreak[0]}

\lstdefinestyle{consola}
{basicstyle=\scriptsize\bf\ttfamily}

\lstdefinestyle{}{language=c++,}

\begin{document}

\title{\bf \LARGE Moogle!}
\author{Eduardo Brito Labrada}
\date{\today}

\maketitle

\section*{Una breve introducci\'on}

Moogle! es una aplicación {\it totalmente original} cuyo propósito es buscar inteligentemente un texto en un conjunto de documentos. Es una aplicación web, desarrollada con tecnología {\tt \color{gray45}.NET Core 6.0}, específicamente usando Blazor como {\it framework} web para la interfaz gráfica, y en el lenguaje {\tt \color{gray45} C\#}.
La aplicación está dividida en dos componentes fundamentales:

\begin{itemize}
	\item {\tt \color{gray45} MoogleServer} es un servidor web que renderiza la interfaz gráfica y sirve los resultados.
	\item {\tt \color{gray45} MoogleEngine} es una biblioteca de clases donde está\dots ehem\dots casi implementada la lógica del algoritmo de búsqueda.
\end{itemize}

\subsection*{?`Para qu\'e sirve?}

La idea original del proyecto es buscar en un conjunto de archivos de texto (con extensión {\tt \color{gray45} .txt}) que estén en la carpeta {\tt \color{gray45}Content}.

\subsection*{?`C\'omo usarlo?}

Primeramente, se aconseja a quien use esta aplicaci\'on tener instalado \href{https://es.wikipedia.org/wiki/Linux}{Linux}, ya que no se garantiza la misma eficiencia si esta en un dispositivo que use Windows.
En caso de tener instalado Windows, puede optar por \href{https://learn.microsoft.com/es-es/windows/wsl/install}{instalar Windows Subsystem for Linux (WSL)} que a\~nade
funcionalidades de Linux en Windows.

\subsubsection*{Instrucciones}

Lo primero que tendrás que hacer para poder trabajar en este proyecto es \href{https://learn.microsoft.com/es-es/dotnet/core/install/}{instalar {\tt \color{gray45}.NET Core 6.0}}.
Luego, te debes parar en la carpeta del proyecto y dependiendo de tu Sistema Operativo hacer lo siguiente:

\begin{itemize}
	\item {\bf Linux:} Debes tener instalado {\tt \color{gray45} make}. Si no lo tienes instalado
puedes instalarlo usando {\tt \color{gray45}sudo apt update \&\& sudo apt install make}. Luego podr\'as hacer {\tt \color{gray45}make dev}
	
	\item {\bf Windows:} Deberías poder ejecutar este proyecto usando {\tt \color{gray45}dotnet watch run --project MoogleServer}
\end{itemize}

Despu\'es de hacer lo anterior abre en tu navegador \href{http://localhost:5000}{http://localhost:5000} y podr\'as usar Moogle! introduciendo tu b\'usqueda en la ``entrada'' y luego presionando el bot\'on ``Buscar''.

\section*{Motor de b\'usqueda}

El motor de búsqueda usa un modelo vectorial que nos computa para una {\it query} dada 
qué tan relevante es un documento determinado. Este modelo vectorial usa  {\it Term Frequency and Inverse Document Frequency (TF-IDF)} con 
{\it Cosine Similarity} para computar la relevancia. 

Para computar el vector {\it TF-IDF} uso la fórmula:

\[ TFIDF = (\frac{tf}{tw}) \times \ln(\frac{td}{dt}) \]

En esta fórmula tenemos que:
\begin{itemize}
 \item $tf$ es la frecuencia del término en el documento actual.
 \item $tw$ es la cantidad de palabras totales en el documento actual.
 \item $td$ es la cantidad total de documentos a analizar.
 \item $dt$ es la cantidad de documentos que contienen el término.
\end{itemize}

{\bf \color{red} Nota importante}: dado que $\frac{td}{dt}$ puede causar problemas por la 
división entre $0$ decidí que si $dt = 0$ luego $TFIDF = 0$, tiene sentido hacer esto ya 
que si $dt = 0$ el término no aparece en ningún documento.\\

Después de hacer lo anterior necesitamos calcular la ``similitud'' entre el vector de 
{\it document} y el vector de la {\it query}, que para eso utilizo 
{\it Cosine Similarity}. 
Para hacer esto intentamos estimar el ``ángulo'' comprendido entre el vector de la 
{\it query} y el vector de {\it document}: mientras menor sea este ángulo, mayor 
``similitud'' tendrán estos vectores. Esto lo hacemos usando la fórmula:

\[\cos \alpha = \frac{v_d \cdot v_q}{||v_d|| ~ ||v_q||}\]

Siendo:

\begin{itemize}
 \item $v_d$ el vector de {\it document}
 \item $v_q$ el vector de {\it query}
 \item $||v||$ es la magnitud del vector $v$
\end{itemize}

\section*{Sobre la implementaci\'on}

\subsection*{\tt Utils.cs}

Esta clase est\'a principalmente para m\'etodos que son necesarios en varias clases del
proyecto.

\begin{itemize}
	\item {\tt int EditDistance(string a, string b)}:  es el menor n\'umero de operaciones de edici\'on
que se deben hacer para igualar ambas cadenas (las operaciones son insertar un caracter, eliminar un caracter, cambiar un caracter). 
	\item {\tt int LongestCommonPrefix(string a, string b)}: esta clase recibe dos cadenas y
devuelve el prefijo com\'un m\'as largo de dichas cadenas.
	\item {\tt double Distance(string a, string b)}: devuelve la similitud de dos cadenas
esta funci\'on retorna utilizando el {\tt EditDistance} (en lo adelante $ED$) y el 
{\tt LongestCommonPrefix} (en lo adelante $LCP$) de dos cadenas, la distancia que existe 
entre ellas. En este m\'etodo utilizo $\frac{ED}{LCP}$ bas\'andome en que {\tt picta} y {\tt picture}
\end{itemize}


\end{document}
